@{
    Layout = null;
    var token = Context.Request.Cookies["access_token"];
    string userId = null;
    string nickName = null;
    if (!string.IsNullOrEmpty(token))
    {
        token = token.Trim();
        userId = WebApp.Helpers.JwtHelper.GetClaimFromToken(token, "nameid");
        nickName = WebApp.Helpers.JwtHelper.GetClaimFromToken(token, "nickName");
    }
    var isLoggedIn = !string.IsNullOrEmpty(userId);
}
<!DOCTYPE html>
<html lang="tr">
<head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>@ViewData["Title"] - MyBlog.WebApp</title>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" />
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.3/font/bootstrap-icons.css" />
    <link rel="stylesheet" href="~/css/site.css" />
</head>
<body>
    <div class="d-flex flex-row min-vh-100">
        <!-- Sidebar (Kategoriler) -->
        <aside class="sidebar d-none d-lg-flex flex-column align-items-start p-4" style="width: 240px; height: 100vh; position: sticky; top: 0; font-size: 0.9rem; overflow-y: auto; font-family: 'Segoe UI', 'Roboto', 'Arial', sans-serif; font-weight: 600; direction: rtl; background: #f8fafc;">
            <div style="direction: ltr;">
                <div class="mb-4">
                    <h4 class="text-primary mb-3"><i class="bi bi-funnel me-2"></i>Kategoriler</h4>
                </div>
                <div class="mb-3 ms-3">
                    <a href="/Articles" class="text-decoration-none fw-bold d-flex align-items-center gap-2 all-articles-link" style="font-size:1rem; color: #2563eb;">
                        <i class="bi bi-collection"></i> Tüm Makaleler
                    </a>
                </div>
                <style>
                .all-articles-link {
                    padding: 0.2rem 0.1rem;
                    border-radius: 0.4rem;
                    transition: background 0.15s, color 0.15s;
                }
                .all-articles-link:hover {
                    background: #e0e7ff;
                    color: #1e40af;
                    text-decoration: underline;
                }
                .category-link:hover {
                    text-decoration: underline;
                    color: #1e40af !important;
                    background: #f1f5f9;
                    border-radius: 0.3rem;
                    transition: background 0.15s, color 0.15s;
                }
                </style>
                <div class="mb-2" style="font-size:0.95rem;">
                    <a href="/Articles/ArticleByCategory/1" class="text-primary fw-semibold d-flex align-items-center gap-2 category-link" style="font-size:0.95rem; text-decoration:none;">
                        <i class="bi bi-code-slash"></i> Yazılım
                    </a>
                </div>
                <ul class="list-unstyled ms-3 mb-4">
                    <li><a href="/Articles/ArticleBySubCategory/1" class="text-decoration-none text-dark">Backend</a></li>
                    <li><a href="/Articles/ArticleBySubCategory/2" class="text-decoration-none text-dark">Frontend</a></li>
                    <li><a href="/Articles/ArticleBySubCategory/3" class="text-decoration-none text-dark">Mobil</a></li>
                    <li><a href="/Articles/ArticleBySubCategory/8" class="text-decoration-none text-dark">Veri Bilimi</a></li>
                    <li><a href="/Articles/ArticleBySubCategory/10" class="text-decoration-none text-dark">Siber Güvenlik</a></li>
                    <li><a href="/Articles/ArticleBySubCategory/11" class="text-decoration-none text-dark">Yapay Zeka</a></li>
                    <li><a href="/Articles/ArticleBySubCategory/12" class="text-decoration-none text-dark">Oyun Geliştirme</a></li>
                    <li><a href="/Articles/ArticleBySubCategory/13" class="text-decoration-none text-dark">DevOps</a></li>
                    <li><a href="/Articles/ArticleBySubCategory/14" class="text-decoration-none text-dark">Test Mühendisliği</a></li>
                </ul>
                <div class="mb-2" style="font-size:0.95rem;">
                    <a href="/Articles/ArticleByCategory/2" class="text-success fw-semibold d-flex align-items-center gap-2 category-link" style="font-size:0.95rem; text-decoration:none;">
                        <i class="bi bi-cpu"></i> Teknoloji
                    </a>
                </div>
                <ul class="list-unstyled ms-3 mb-4">
                    <li><a href="/Articles/ArticleBySubCategory/4" class="text-decoration-none text-dark">Bulut</a></li>
                    <li><a href="/Articles/ArticleBySubCategory/5" class="text-decoration-none text-dark">Donanım</a></li>
                    <li><a href="/Articles/ArticleBySubCategory/15" class="text-decoration-none text-dark">IoT</a></li>
                    <li><a href="/Articles/ArticleBySubCategory/16" class="text-decoration-none text-dark">Blockchain</a></li>
                    <li><a href="/Articles/ArticleBySubCategory/17" class="text-decoration-none text-dark">AR/VR</a></li>
                </ul>
                <div class="mb-2" style="font-size:0.95rem;">
                    <a href="/Articles/ArticleByCategory/3" class="text-warning fw-semibold d-flex align-items-center gap-2 category-link" style="font-size:0.95rem; text-decoration:none;">
                        <i class="bi bi-people"></i> Topluluk
                    </a>
                </div>
                <ul class="list-unstyled ms-3 mb-4">
                    <li><a href="/Articles/ArticleBySubCategory/6" class="text-decoration-none text-dark">Etkinlikler</a></li>
                    <li><a href="/Articles/ArticleBySubCategory/7" class="text-decoration-none text-dark">Üniversite & Bölümler</a></li>
                    <li><a href="/Articles/ArticleBySubCategory/18" class="text-decoration-none text-dark">Soru-Cevap</a></li>
                    <li><a href="/Articles/ArticleBySubCategory/19" class="text-decoration-none text-dark">Projeler</a></li>
                </ul>
                <div class="mt-auto pt-4">
                    <small class="text-muted">© 2025 Benim Blogum</small>
                </div>
            </div>
        </aside>
        <div class="flex-grow-1 d-flex flex-column">
            <!-- Header (Navbar) -->
            <header class="bg-white shadow-sm mb-4">
                <div class="container">
                    <nav class="navbar navbar-expand-lg navbar-light bg-white d-flex justify-content-between align-items-center p-0">
                        <div class="d-flex align-items-center">
                            <button class="btn btn-outline-secondary btn-sm me-2 d-lg-none" type="button" data-bs-toggle="offcanvas" data-bs-target="#sidebarOffcanvas" aria-controls="sidebarOffcanvas">
                                <i class="bi bi-list"></i>
                            </button>
                            <a class="navbar-brand fw-bold text-primary" href="/">Benim Blogum</a>
                        </div>
                        <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNav" aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation">
                            <span class="navbar-toggler-icon"></span>
                        </button>
                        <div class="collapse navbar-collapse justify-content-end" id="navbarNav">
                            <ul class="navbar-nav mb-2 mb-lg-0 align-items-lg-center gap-lg-2">
                                <li class="nav-item">
                                    <a class="nav-link" href="/"><i class="bi bi-house-door"></i> Anasayfa</a>
                                </li>
                                <li class="nav-item">
                                    <a class="nav-link" href="#"><i class="bi bi-person"></i> Hakkımda</a>
                                </li>
                                <li class="nav-item">
                                    <a class="nav-link" href="#"><i class="bi bi-question-circle"></i> Yardım</a>
                                </li>
                                @if (isLoggedIn)
                                {
                                    <li class="nav-item">
                                        <a class="nav-link" asp-controller="Articles" asp-action="Create">Makale Yaz</a>
                                    </li>
                                    <li class="nav-item d-lg-none">
                                        <hr class="my-2">
                                        <div class="d-flex gap-2 mt-2">
                                            <a class="btn btn-outline-primary btn-sm w-100" href="/Account/Profile"><i class="bi bi-person-circle"></i> Profilim</a>
                                            <form method="post" action="/Account/Logout" style="margin:0;">
                                                <button type="submit" class="btn btn-danger btn-sm w-100"><i class="bi bi-box-arrow-right"></i> Çıkış Yap</button>
                                            </form>
                                        </div>
                                    </li>
                                }
                                else
                                {
                                    <li class="nav-item d-lg-none">
                                        <hr class="my-2">
                                        <div class="d-flex gap-2 mt-2">
                                            <a class="btn btn-outline-primary btn-sm w-100" href="/Account/Login"><i class="bi bi-box-arrow-in-right"></i> Giriş Yap</a>
                                            <a class="btn btn-primary btn-sm w-100" href="/Account/Register"><i class="bi bi-person-plus"></i> Kayıt Ol</a>
                                        </div>
                                    </li>
                                }
                            </ul>
                            <div class="ms-auto d-none d-lg-flex gap-2 align-items-center">
                                @if (isLoggedIn)
                                {
                                    <div class="dropdown">
                                        <button class="btn btn-light d-flex align-items-center gap-2 px-3 py-1 border rounded-pill shadow-sm" type="button" id="profileDropdown" data-bs-toggle="dropdown" aria-expanded="false" style="font-weight:500;">
                                            <span class="bg-primary text-white rounded-circle d-flex align-items-center justify-content-center" style="width:32px; height:32px; font-size:1.1rem; font-weight:600;">
                                                @(string.IsNullOrEmpty(nickName) ? "U" : nickName.Substring(0,1).ToUpper())
                                            </span>
                                            <span class="me-1">@(string.IsNullOrEmpty(nickName) ? "Kullanıcı" : nickName)</span>
                                            <i class="bi bi-caret-down-fill"></i>
                                        </button>
                                        <ul class="dropdown-menu dropdown-menu-end mt-2 shadow-sm" aria-labelledby="profileDropdown">
                                            <li><a class="dropdown-item" href="/Account/Profile"><i class="bi bi-person-circle me-2"></i>Profilim</a></li>
                                            <li><hr class="dropdown-divider"></li>
                                            <li><form method="post" action="/Account/Logout" style="margin:0;"><button type="submit" class="dropdown-item text-danger"><i class="bi bi-box-arrow-right me-2"></i>Çıkış Yap</button></form></li>
                                        </ul>
                                    </div>
                                }
                                else
                                {
                                    <a class="btn btn-outline-primary btn-sm" href="/Account/Login"><i class="bi bi-box-arrow-in-right"></i> Giriş Yap</a>
                                    <a class="btn btn-primary btn-sm" href="/Account/Register"><i class="bi bi-person-plus"></i> Kayıt Ol</a>
                                }
                            </div>
                        </div>
                    </nav>
                </div>
                <!-- Search Bar -->
                <div class="search-bar-wrapper py-3" style="background: #f8fafc;">
                    <form class="container d-flex justify-content-center" role="search">
                        <input class="form-control w-50 me-2" type="search" placeholder="Makale, yazar veya etiket ara..." aria-label="Ara">
                        <button class="btn btn-primary" type="submit"><i class="bi bi-search"></i> Ara</button>
                    </form>
                </div>
            </header>
            <!-- Main Content -->
            <main class="container flex-grow-1">
                @RenderBody()
            </main>
            <!-- Footer (İletişim) -->
            <footer class="bg-light text-center py-3 mt-5">
                <div class="container">
                    <p class="mb-0 small text-muted">&copy; 2025 Benim Blogum. Tüm hakları saklıdır.</p>
                </div>
            </footer>
        </div>
    </div>
    <!-- Mobile Sidebar Offcanvas -->
    <div class="offcanvas offcanvas-start" tabindex="-1" id="sidebarOffcanvas" aria-labelledby="sidebarOffcanvasLabel">
        <div class="offcanvas-header">
            <h5 class="offcanvas-title" id="sidebarOffcanvasLabel">
                <i class="bi bi-funnel text-primary me-2"></i>Filtrele
            </h5>
            <button type="button" class="btn-close" data-bs-dismiss="offcanvas" aria-label="Close"></button>
        </div>
        <div class="offcanvas-body">
            <div class="sidebar-mobile">
                <!-- Sidebar mobile içeriği -->
            </div>
        </div>
    </div>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"></script>
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/jquery-validation@1.19.5/dist/jquery.validate.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/jquery-validation-unobtrusive@3.2.12/dist/jquery.validate.unobtrusive.min.js"></script>
    @RenderSection("Scripts", required: false)
</body>
</html>